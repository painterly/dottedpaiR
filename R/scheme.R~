#' dottedpaiR
#' Scheme functions in R
#'
#' @export
#' @name Scheme
#'
#' @param ls list
#' @param f function
#' @param l list
#' @param s list
#' @param x number
#' @param a number
#' @param d number
#' @examples
#' cons(3,cons(4,nil))
#' cdr(cons(3,cons(4,nil)))




nil <- pairlist()

null_huh <- function(x) {
  is.null(x)
}

pair_huh <- function(x) {
  is.pairlist(x) && !is.null(x)
}

cons <- function(a,d) {
  pairlist(a,d)
}

car <- function(ls) {
  ls[[1]]
}

cdr <- function(ls) {
  ls[[2]]
}

cadr <- function(ls) {
  car(cdr(ls))
}

cdar <- function(ls) {
  cdr(car(ls))
}

caddr <- function(ls) {
  car(cdr(cdr(ls)))
}

caadr <- function(ls) {
  car(car(cdr(ls)))
}

cddr <- function(ls) {
  (cdr(cdr(ls)))
}

cadar <- function(ls) {
  car(cdr(car (ls)))
}


list_length <- function(ls) {
  if (null_huh(ls))
    { 0 }
  else
    { 1 + list_length(cdr(ls)) }
}

list_append <- function(l,s) {
  if (null_huh(l))
    { s }
  else
    { cons(car(l), list_append(cdr(l), s)) }
}

list_map <- function(f,ls) {
  if (null_huh(ls))
    { nil }
  else
    { cons(f(car(ls)), list_map(f, cdr(ls))) }
}
